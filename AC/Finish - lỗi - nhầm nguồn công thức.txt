=IF(COUNTBLANK($B12)=1,"",TRIM(SUBSTITUTE(JOIN(" ",$U12,PROPER(JOIN("/",ARRAYFORMULA( VLOOKUP( SPLIT( $D12, "/" ), Data!$A$2:$B$55, 2 ) ) )),IFERROR(REGEXEXTRACT(L12,"Proto Nazca|Huari|Inca|Nazca"),""),IF(COUNTBLANK($T12)=1,"","needlepoint"),IF(REGEXMATCH($J12,"silk"),IF(COUNT(SEARCH({"on","and",","},$J12))=2,"","silk"),""),IF( COUNTBLANK( $C12 ) = 1, "", JOIN("/",ARRAYFORMULA( VLOOKUP( SPLIT( $C12, "/" ), Data!$C$2:$G$43, IF( COUNTBLANK( $U12 ) = 1, 4, 5 ), FALSE ) ) ) ),IF(RegExMatch($L12,"Huari|Inca|Nazca"),$M12,$L12&" "&IF(COUNTBLANK($L12)=1,$M12,"")),$N12,$P12,$Q12,IF(ISBLANK(R12),"",SUBSTITUTE($R12," and "," ")),IF( ISBLANK( $S12 ), "",CHAR(34)& $S12 & CHAR(34)),IFS(Regexmatch($L12, "Huari|Inca|Nazca"),"Pre-Columbian",ISNUMBER($E12 ), $E12,NOT(ISNUMBER($E12 )),INDEX(Data!$B$62:$B$128,IFERROR(MATCH(TRUE,ARRAYFORMULA(REGEXMATCH(TO_TEXT($E12),TO_TEXT(Data!$A$62:$A$127))),0),67)),TRUE,"")),CHAR(32)," ")))